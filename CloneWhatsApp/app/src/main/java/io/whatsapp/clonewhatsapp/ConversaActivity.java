package io.whatsapp.clonewhatsapp;import android.os.Bundle;import android.support.v7.app.AppCompatActivity;import android.support.v7.widget.Toolbar;import android.view.View;import android.widget.EditText;import android.widget.ImageButton;import android.widget.Toast;import com.google.firebase.database.DatabaseReference;import io.whatsapp.clonewhatsapp.base64.Codificacao;import io.whatsapp.clonewhatsapp.firebase.ConfigFireBase;import io.whatsapp.clonewhatsapp.helpers.Preferencias;import io.whatsapp.clonewhatsapp.model.Mensagem;public class ConversaActivity extends AppCompatActivity {    private Toolbar tb;    private String nomeUsuarioDestinatario;    private ImageButton btn_img;    private EditText editMensagem;    //dados remetente    private String uidUsuarioRemetente;    private String uidUsuarioDestinatario;    private DatabaseReference firebase;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_conversa);        tb = (Toolbar) findViewById(R.id.tb_conversa);        btn_img = (ImageButton) findViewById(R.id.bt_enviar);        editMensagem = (EditText) findViewById(R.id.edit_mensagem);        //recebendo dados de outra activity        Bundle extra = getIntent().getExtras();        //recupendo dados do remetente        Preferencias p = new Preferencias(ConversaActivity.this);        uidUsuarioRemetente = p.getIdentificador();        if( extra != null ){            nomeUsuarioDestinatario = extra.getString("nome");            String emailDestinatario = extra.getString("email");            uidUsuarioDestinatario = Codificacao.codificacaoBase64( emailDestinatario );        }        //title        tb.setTitle( nomeUsuarioDestinatario );        tb.setNavigationIcon(R.drawable.ic_action_arrow_left);        setSupportActionBar( tb );        //enviando mensagem        btn_img.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                String mensgam = editMensagem.getText().toString();                if(mensgam.isEmpty()){                    Toast.makeText(ConversaActivity.this, "DIGITE UMA MENSAGEM", Toast.LENGTH_LONG).show();                }else{                    Mensagem m = new Mensagem();                    m.setUidUsuario( uidUsuarioRemetente );                    m.setMensagem( mensgam );                    salvarMensagem(uidUsuarioRemetente, uidUsuarioDestinatario, m);                    editMensagem.setText("");                }            }        });    }    private boolean salvarMensagem(String idRemetente, String idDestinatario, Mensagem m){        try {            firebase = ConfigFireBase.getFirebase().child("mensagem");            firebase.child( idRemetente )                    .child( idDestinatario )                    .push()                    .setValue( m );            return true;        }catch (Exception e){            e.printStackTrace();            return false;        }    }}